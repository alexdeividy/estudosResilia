-- AULA 18 --

# CASE + WHEN

SELECT NOME, PRECO,

CASE
	WHEN PRECO > 55 THEN 'PIZZA CARA'
	WHEN PRECO > 45 THEN 'PIZZA BOA'
	ELSE 'PIZZA BARATA'
END AS GASTOS

FROM TB_PIZZA;

-- ATIVIDADES AULA 18 --

-- ATIVIDADE 1 --

SELECT TB_CLIENTE.NOME, TB_PIZZA.NOME, 
COALESCE (TB_PEDIDO.ID_PEDIDO::TEXT, 'Nunca realizou pedido') AS ID_PEDIDO
FROM TB_CLIENTE
LEFT JOIN TB_PEDIDO
ON TB_CLIENTE.id_cliente = TB_PEDIDO.id_cliente
LEFT JOIN TB_PEDIDO_PIZZA
ON TB_PEDIDO.id_pedido = TB_PEDIDO_PIZZA.id_pedido
LEFT JOIN TB_PIZZA
ON TB_PEDIDO_PIZZA.id_pizza = TB_PIZZA.id_pizza
GROUP BY TB_CLIENTE.NOME, TB_PEDIDO.ID_PEDIDO, TB_PIZZA.NOME, TB_CLIENTE.id_cliente
ORDER BY TB_CLIENTE.ID_CLIENTE;

--ATIVIDADE 2

--1
SELECT NOME, DESCRICAO, PRECO,
CASE
	WHEN DESCRICAO LIKE '%presunto%' THEN 'TEM PRESUNTO'
	ELSE 'N√ÉO TEM PRESENTO'
END AS PRESUNTO

FROM TB_PIZZA


--2
SELECT NOME, PRECO
FROM TB_PIZZA
WHERE PRECO = (SELECT MIN(PRECO) FROM TB_PIZZA)
LIMIT 5

SELECT NOME, PRECO
FROM TB_PIZZA
WHERE PRECO <= 50
LIMIT 5

--3

SELECT A.ID_PIZZA, A.NOME, COUNT(B.ID_PEDIDO) AS QUANTIDADE
FROM TB_PIZZA A
RIGHT JOIN TB_PEDIDO_PIZZA B ON A.ID_PIZZA = B.ID_PIZZA
GROUP BY A.ID_PIZZA, A.NOME
ORDER BY COUNT(B.ID_PEDIDO) DESC
LIMIT 10